name: Deploy Snapshot Artifact

on:
  workflow_dispatch:
    inputs:
      artifact:
        type: choice
        description: Artifact ID
        options:
          - iot-gtfs-collector
          - iot-gps-collector

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1

      - name: Set up JDK 17
        uses: actions/setup-java@v1
        with:
          java-version: 17
          cache: 'maven'

      - name: Chane directory to ${{ inputs.artifact }}
        run: cd ${{ inputs.artifact }}

      - name: Build with Maven
        run: mvn package -DskipTests

      - name: Read Snapshot version
        id: snapshot
        uses: christian-draeger/read-properties@1.1.1
        with:
          path: 'target/maven-archiver/pom.properties'
          properties: 'artifactId groupId version'

      - name: Print snapshot version
        run: echo ${{ steps.snapshot.outputs.version }}

#      - name: Nexus Repo Publish
#        uses: sonatype-nexus-community/nexus-repo-github-action@master
#        with:
#          serverUrl: http://163c6cdd.ngrok.io
#          username: admin
#          password: ${{ secrets.password }}
#          format: maven2
#          repository: maven-releases
#          coordinates: groupId=com.example artifactId=app version=1.0.0
#          assets: extension=jar
#          filename: ./target/app-1.0.0.jar
#
#jobs:
#  build:
#    runs-on: ubuntu-latest
#    name: Build Artifact ${{ inputs.artifact }}
#    steps:
#      - uses: actions/checkout@v3
#      - name: Set up JDK 17
#        uses: actions/setup-java@v3
#        with:
#          java-version: '17'
#          distribution: 'temurin'
#          cache: 'maven'
#      - run: |
#          cd ${{ inputs.artifact }}
#          pwd
#          mvn clean verify
#          mkdir staging
#          cp  ${{ inputs.artifact }}/target/*.jar staging
